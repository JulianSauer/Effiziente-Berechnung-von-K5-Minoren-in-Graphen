% kapitel3.tex
\chapter{Algorithmus von Kezdy und McGuinness}
\label{cha:algorithmuskezdymcguinness}

Da die Arbeit auf dem sequenziellen Algorithmus von Kezdy und McGuinness, den sie in \cite{KeM92} vorstellen, beruht, wird er im Folgenden erklärt.
Als Eingabe wird ein ungerichteter Graph ohne Mehrfachkanten erwartet, ausgegeben wird, ob ein $K_5$-Minor enthalten ist oder nicht.
Für den Fall, dass einer gefunden wurde, kann zusätzlich ausgegeben werden, welche Knoten den Minor formen.
Die Laufzeit liegt in $\mathcal{O}(n^2)$

Planaritätstests können bereits in linearer Laufzeit entscheiden, ob ein Graph planar ist oder einen \kf- \bzw \kdd-Minor enthält.
Es muss lediglich der Fall behandelt werden, in dem der der Test stoppt, weil er einen \kdd-Minor gefunden hat, denn es kann nicht garantiert werden, ob zusätzlich ein \kf-Minor enthalten ist.
Als Lösung testet der Algoritmus von Kezdy und McGuinness, ob ein gefundener \kdd-Minor ein \dd-Separator ist und zerlegt \ggf den Graph in augmentierte Komponenten.
Anschließend kann der Planaritätstest auf die einzelnen Komponenten rekursiv angewendet werden.


\section{Behandlung von \kdd-Minoren}
\label{sec:behandlung_von_kdd_minoren}

Um das zentrale Theorem aus \cite{KeM92}, welches den \kdd-Minor untersucht, zu erklären, wird zunächst die Gültigkeit augmentierter Komponenten behandelt:
\begin{theorem}\label{eq:Theorem33}
  Für $k \geq 3$: Sei $G$ ein $k$-zusammenhängender Graph und $C$ ein $k$-Separator in $G$.
  Alle durch $C$ definierten augmentierten Komponenten sind Minoren von $G$, falls es entweder mindestens $k$ Komponenten sind oder mindestens zwei der Komponenten jeweils aus mehr als einem Knoten bestehen.
\end{theorem}
\begin{beweis}
  Seien $c_1, c_2, ..., c_k$ die Knoten von $C$ und $Z = \{Z_1, Z_2, ..., Z_k\}$ \bzw $Z = \{Z_1, Z_2, ..., Z_{k-1}\}$ die Zusammenhangskomponenten, die durch $G \setminus C$ entstehen.
  Die zugehörigen augmentierten Komponenten seien $A_1, A_2, ..., A_k$ \bzw $A_1, A_2, ..., A_{k-1}$.
  Betrachtet wird eine beliebige dieser augmentierten Komponenten $A_i$.
  Der Definition der augmentierten Komponenten nach finden sich bereits alle Knoten von $A_i$ in $G$ wieder. % Teilgraph
  Weiterhin enthält $G$ mindestens alle Kanten in $A_i \setminus C$ sowie die verbindenden Kanten zwischen $A_i$ und $C$.
  Jedoch bilden in $A_i$ die Knoten von $C$ eine Clique, es existieren also \ggf Kanten zwichen den Knoten von $C$ in $A_i$, die es nicht in $G$ gibt
  Es bleibt zu zeigen, dass die Kanten, die für diese Clique in $A_i$ nötig sind, durch Kantenkontraktionen in $G$ erzeugt werden können.
  Dadurch, dass $G$ $k$-zusammenhängend ist, besitzt jede Zusammenhangskomponente von $G \setminus C$ Kanten zu $c_1, c_2, ..., c_k$.
  Würde eine Kante zu einem Knoten $c_j$ mit $1 \leq j \leq k$ fehlen, wäre ein $k-1$-Separator bestehend aus $C \setminus c_j$ möglich, was im Widerspruch zu dem $k$-Zusammenhang stehen würde.
  Das Theorem unterscheided nun zwei Fälle, um die fehlenden Kanten bereitstellen zu können:
  \begin{enumerate}
    \item Es existieren $k$ Zusammenhangskomponenten.
          Wird $A_i$ betrachtet, kommen die Knoten in $Z \setminus Z_i$ in Frage, um durch Kantenkontraktionen die fehlenden Kanten für die Clique von $C$ in $A_i$ zu erzeugen.
          Um die Kanten von $C$ in $A_i$ in $G$ zu erzeugen, kann zunächst der Pfad, der $c_1$ mit $Z_1$ verbindet, kontrahiert werden.
          Anschließend ist $c_1$ mit allen Knoten in $C$ verbunden.
          Dies kann analog für alle Knoten in $C$ und den entsprechenden Zusammenhangskomponenten durchgeführt werden außer für $c_i$, da $A_i$ der gesuchte Minor ist.
          Allerdings ist $c_i$ aufgrund des $k$-Zusammenhangs mit allen anderen Zusammenhangskomponenten verbunden und nach den beschriebenen Kontraktionen bildet $C$ eine Clique.
    \item Es existieren $k-1$ Komponenten, aber mindestens zwei bestehen aus mehr als einem Knoten.
          Analog zum vorherigen Fall können die Pfade zwischen den Knoten von $C$ und den Zusammenhangskomponenten $A$ kontrahiert werden.
          Es fehlt jedoch ein Pfad, da eine Zusammenhangskomponente weniger vorliegt.
          Es gibt mindestens eine Zusammenhangskomponente aus $Z \setminus Z_i$, die aus zwei oder mehr Knoten besteht.
          Da der Graph $k$-zusammenhängend ist, sind mindestens zwei dieser Knoten mit allen in $C$ verbunden, sodass sie durch Kontraktionen mit zwei unterschiedlichen Knoten aus $C$ genutzt werden könnenm um die gesuchte Clique zu erzeugen.
  \end{enumerate}
\end{beweis}

Als nächstes stellen Kezdy und McGuinness fest, dass im Fall eines \dd-Separators der Graph in augmentierte Komponenten zerlegt werden kann:
\begin{theorem}\label{eq:Theorem34}
  Sei $G$ ein $3$-zusammenhängender Graph mit einem \dd-Separator $C$.
  $G$ hat einen \kf-Minor, falls eine der durch $C$ definierten augmentierten Komponenten einen \kf-Minor enthält.
\end{theorem}
\begin{beweis}
  Zunächst kann festgestellt werden, dass falls eine der augmentierten Komponenten einen \kf-Minor enthält, dieser laut Theorem \ref{eq:Theorem33} auch ein Minor von $G$ ist.
  Es bleibt zu zeigen, dass sich ein \kf-Minor nicht auf zwei augmentierte Komponenten erstreckt, sondern sich ausschließlich in einer befindet.
  Angenommen es gilt \kf \minor $G$ und zwei der Branch-Sets, die den \kf-Minor bilden, befinden sich jeweils vollständig in unterschiedlichen Zusammenhangskomponenten.
  In diesem Fall wäre $C$ ein $3$-Separator in dem gefundenen Minor, was im Widerspruch zu dem $4$-Zusammenhang des \kf steht.
\end{beweis}

Das zentrale Theorem ist darauf zurückzuführen, dass jeder Graph ohne \kf-Minor durch Cliquen-Summen von Teilgraphen, die planar oder isomorph zu $W$ sind, gebildet werden kann.\cite{Wag37}
\begin{theorem}\label{eq:Theorem36}
  Sei $G$ ein $3$-zusammenhängender Graph mit einem \kdd-Homöomorph $S$, dessen Branch-Ends die rote Knotenmenge $R = \{a, b, c\}$ und blaue $B = \{x, y, z\}$ unterteilt sind.
  Eine der folgenden Bedingungen trifft auf $G$ zu:
  \begin{enumerate}
    \item $G$ enthält einen \kf-Minor.\label{eq:Theorem361}
    \item $G$ ist isomorph zu $W$.\label{eq:Theorem362}
    \item $\{a, b, c\}$ bilden einen $3$-Separator, sodass $\{x, y, z\}$ in separaten Komponenten liegen.\label{eq:Theorem363}
    \item $\{x, y, z\}$ bilden einen $3$-Separator, sodass $\{a, b, c\}$ in separaten Komponenten liegen.\label{eq:Theorem364}
  \end{enumerate}
\end{theorem}
Durch die Theoreme \ref{eq:Theorem33} und \ref{eq:Theorem34} wurde gezeigt, dass der Graph in den Fällen \ref{eq:Theorem363} und \ref{eq:Theorem364} in augmentierte Komponenten zerlegt und darauf der Planaritätstest ausgeführt werden kann.
Anschließend stellen die Autoren einige Lemmata auf, mit denen untersucht wird, ob $S$ einen \kf-Minor enthält - also ob Bedingung \ref{eq:Theorem361} zutrifft.

% TODO: Bilder zum Lemma und M
\begin{lemma}\label{eq:Lemma32}
  Sei $G$ ein $3$-zusammenhängender Graph und $S$ ein \kdd-Homöomorph in $G$.
  Hat ein Knoten $w$ in $G \setminus S$ drei Pfade zu Knoten in $S$, die nicht alle im selben Branch-Fan liegen, enthält $G$ einen \kf-Minor.
\end{lemma}
\begin{beweis}
  Seien $t, u, v$ die drei Endpunkte der Pfade in $S$.
  Mindestens einer von ihnen ist ein innerer Knoten, da sonst alle im selben Branch-Fan liegen würden.
  Sei \oBdA $t$ ein solcher innerer Knoten auf dem Pfad $P(a, x)$.
  Folglich können $u$ und $v$ nicht beide in $F(a)$ oder $F(x)$ liegen, sonst lägen alle drei im gleichen Branch-Fan.
  \begin{enumerate}
    \item $u$ und $v$ sind nicht im gleichen Branch-Fan wie $t$. \label{eq:Lemma321}
          Dann müssen $u$ und $v$ ebenfalls innere Knoten sein, im Beispiel auf den Pfaden $P(y, b)$ \bzw $P(z, c)$.
          Es kann ein $M$-Minor durch folgende Kontraktionen erzeugt werden: $u$ mit einem der roten und $v$ mit einem der blauen Knoten (analog $u$ mit blau und $v$ mit rot) sowie $P(w, t)$.
    \item $u$ oder $v$ liegen auf $P(a, x)$. \label{eq:Lemma322}
          Sei \oBdA $u \in P(a, x)$.
          Da $t$ ebenfalls in diesem Pfad liegt, gilt $\{t, u\} \in F(a) \cup F(x)$, sodass $v$ nicht in diesen beiden Branch-Fans liegen kann.
          Es können $t$ und $v$ getauscht werden, sodass eine Reduktion auf Fall \ref{eq:Lemma321} erreicht wird.
    \item Entweder $u$ oder $v$ liegen im gleichen Branch-Fan wie $t$. \label{eq:Lemma323}
          Sei \oBdA $u \in F(x) \setminus P(a, x)$, im Beispiel auf dem Pfad $P(b, x)$.
          Es gilt $\{t, u\} \in F(x)$, weshalb $v$ in einem anderen Branch Fan sein muss.
          Da alle roten Knoten in $F(x)$ liegen, gilt konkreter $v \in (F(y) \cup F(z)) \setminus \{a, b, c\}$
          Es können $P(b, u)$ kontrahiert werden sowie je nach Fall entweder $P(v, y)$ oder $P(v, z)$.
          Wird $P(w, t)$ ebenfalls kontrahiert, entsteht erneut ein $M$-Minor.
  \end{enumerate}
\end{beweis}

\begin{lemma}\label{eq:Lemma33}
  Sei $G$ ein $3$-zusammenhängender Graph und $S$ ein \kdd-Homöomorph in $G$.
  Betrachtet wird ein Pfad außerhalb von $S$, der zwei Knoten in einem roten Branch-Fan verbindet, welche jedoch nicht beide auf dem gleichen Pfad in $S$ liegen.
  Analog dazu wird ein Pfad außerhalb von $S$ gesucht, der zwei Knoten in einem blauen Branch-Fan verbindet, ohne dass diese beide auf dem gleichen Pfad in $S$ liegen.
  Existieren diese beiden Pfade in $G$, dann enthält $G$ einen \kf-Minor.
\end{lemma}
\begin{beweis}
  Sei $P_1$ der Pfad, der zwei Knoten in einem roten Branch-Fan verbindet und $P_2$ der, der zwei in einem blauen Branch-Fan verbindet.
  \OBdA hat $P_1$ Endpunkte in $F(a)$ und $P_2$ in $F(x)$.
  Da laut Bedingung die Endpunkte nicht in einem einzelnen Pfad von $S$ liegen, kann $a$ kein Endpunkt von $P_1$ und $x$ kein Endpunkt von $P_2$ sein.
  Es ergeben sich zwei Fälle:
  \begin{enumerate}
    \item Die beiden Pfade haben keine gemeinsamen Knoten
          Da $P_1$ beide Endpunkte in $F(a)$ hat, liegen diese beiden Endpunkte in zwei unterschiedlichen blauen Branch-Fans.
          Entsprechend sind die Endpunkte von $P_2$ in unterschiedlichen roten Branch-Fans.
          Werden die Endpunkte von $P_1$ je mit den beiden blauen und die von $P_2$ mit den beiden roten Knoten von $S$ kontrahiert, entsteht ein \kf-Minor. % TODO: Skizze
    \item Die beiden Pfade haben einen gemeinsamen Knoten $w$.
          Liegt dieser gemeinsame Knoten außerhalb von $S$, kann Lemma \ref{eq:Lemma32} angewendet werden, da die Endpunkte der Pfade nicht alle im gleichen Branch-Fan liegen.
          Liegt $w$ innerhalb von $S$, ist er ein Endpunkt von $P_1$ und $P_2$ und muss auf dem Pfad $P(a, x)$ liegen, da dieser der einzige gemeinsame Pfad ist.
          Sei $P_1 = P(w, u)$ und $P_2 = P(w, v)$.
          Da $u$ nicht in $F(x)$ liegt und $v$ nicht in $F(a)$, gibt es einen Pfad von $u$ zu einem blauen Knoten und von $v$ zu einem roten Knoten, die sich nicht kreuzen und daher kontrahiert werden können.
          Durch die Kontraktion dieser beiden Pfade entsteht ein $M$-Minor. % TODO: Skizze
  \end{enumerate}
\end{beweis}

\begin{lemma}\label{eq:Lemma34}
  Sei $G$ ein $3$-zusammenhängender Graph und $S$ ein \kdd-Homöomorph in $G$.
  Betrachtet wird ein Pfad außerhalb von $S$, der zwei innere Knoten paralleler Pfade in $S$ verbindet sowie ein Pfad außerhalb von $S$, dessen Endpunkte nicht beide im gleichen Pfad von $S$ liegen.
  Bestehen die Endpunkte der beiden Pfade aus mindestens drei unterschiedlichen Knoten in $S$, enthält $G$ einen \kf-Minor.
\end{lemma}
% TODO: Beweis?

\begin{lemma}\label{eq:Lemma35}
  Sei $G$ ein $3$-zusammenhängender Graph und $S$ ein \kdd-Homöomorph in $G$ mit den roten Knoten $R = \{a, b, c\}$ und den blauen Knoten $B = \{x, y, z\}$.
  Bilden weder $R$, noch $B$ einen \dd-Separator, enthält $G$ einen \kf-Minor.
\end{lemma}
\begin{beweis}
  Falls $R$ und $B$ keinen \dd-Separator bilden, ist sowohl der Graph $G \setminus R$ als auch $G \setminus B$ zusammenhängend.
  Sei $P_1$ ein Pfad, der zwei blaue Branch-Fans in $G \setminus R$ und $P_2$ einer, der zwei rote Branch-Fans in $G \setminus B$ verbindet.
  Beide liegen außerhalb von $S$.
  Die Endpunkte von $P_1$ seien $u_1$ und $v_1$, die von $P_2$ seien $u_2$ und $v_2$.
  $u_1$ und $v_1$ besitzen jeweils einen Pfad in $S$ zu einem der roten Knoten.
  Foglich gibt es einen dritten roten Knoten, der keinen solchen Pfad besitzt - $u_2$ wird so gewählt, dass er in dem Branch-Fan dieses Knotens liegt. % TODO Skizze
  Demnach sind $u_1$, $v_1$ und $u_2$ unterschiedliche Knoten.
  Anschließend kann je nach vorliegendem Fall die Aussage auf eines der vorherigen Lemmata reduziert werden:
  \begin{enumerate}
    \item $P_1$ oder $P_2$ verbindet zwei parallele Pfade in $S$.
          In dem Fall kann Lemma \ref{eq:Lemma34} angewendet werden und $G$ enthält einen \kf-Minor.
    \item Die Endpunkte von $P_1$ liegen in einem einzelnen roten Branch-Fan - analog liegen die von $P_2$ in einem blauen.
          Nach Lemma \ref{eq:Lemma33} enthält $G$ einen \kf-Minor.
  \end{enumerate}
\end{beweis}

\begin{lemma}\label{eq:Lemma36}
  Sei $G$ ein $3$-zusammenhängender Graph mit einem $W$-Homöomorph.
  Ist $G$ nicht isomorph zu $W$, enthält $G$ einen \kf-Minor.
\end{lemma}
% Beweis?

Als nächstes folgt der Beweis zu \ref{eq:Theorem36}.
\begin{beweis}
  Gezeigt wird, dass falls $S$ keinen \dd-Separator bildet, $G$ entweder einen \kf-Minor enthält oder isomorph zu $W$ ist.
  Falls kein \kf-Minor enthalten ist, gilt nach Lemma \ref{eq:Lemma35}, dass $G \setminus R$ oder $G \setminus B$ nicht zusammenhängend ist.
  Demnach ist $B$ ein $3$-Separator, der den Graph teilt, aber die Knoten aus $R$ liegen nicht alle in unterschiedlichen Zusammenhangskomponenten.
  Deshalb muss es außerhalb von $S$ mindestens einen Pfad $P_1$ geben, der zwei der roten Knoten in $G - B$ verbindet.
  Analog gibt es einen Pfad $P_2$, der zwei blaue Knoten in $G - R$ verbindet.
  Da $P_1$ zwei rote Branch-Fans verbindet, liegen seine Endpunkte in zwei verschiedenen Pfaden von $S$.
  Gleiches gilt für die Endpunkte von $P_2$.
  Liegen die Endpunkte von $P_1$ beide in einem einzelnen blauen Branch-Fan und die von $P_2$ in einem einzelnen roten, dann enthält $G$ laut Lemma \ref{eq:Lemma33} einen \kf-Minor.
  Liegen die Endpunkte von $P_1$ in parallelen Pfaden von $S$, enthält $G$ laut Lemma \ref{eq:Lemma34} einen \kf-Minor, da die Endpunkte von $P_2$ nicht auf einem Pfad von $S$ liegen (analog falls $P_2$ auf parallelen Pfaden liegt).
  Übrig bleibt die Möglichkeit, dass die Endpunkte der beiden Pfade paarweise identisch sind.
  Dann ist $G$ ein Homöomorph zu $W$ und enthält laut Lemma \ref{eq:Theorem36} keinen \kf-Minor bei Isomorphie zu $W$.
\end{beweis}


\section{Sequenzieller Algorithmus zum Finden von \kf-Minoren}
\label{sec:sequenzieller_algorithmus_zum_finden_von_kf_minoren}

Da die Theoreme größtenteils auf $3$-zusammenhängenden Graphen arbeiten, muss der Eingabegraph \ggf zunächst angepasst werden, bevor der Planaritätstests angewendet werden kann.
Ist der Graph $1$-zusammenhängend, gibt es einen Knoten, der einen $(1, j)$-Separator für $j \geq 2$ bildet.
Genauso müssen zwei Knoten existieren, die einen $(2, j)$-Separator bilden, falls der Graph $2$-zusammenhängend ist.
In beiden Fällen kann der Separator benutzt werden, um den Graph in $j$ augmentierte Komponenten zu zerlegen.
Anschließend kann der $3$-Zusammenhang der einzelnen Komponenten rekursiv geprüft werden.
Sind die Komponenten alle $3$-zusammenhängend, kann auf jede ein Planaritätstest angewendet werden.
Kezdy und McGuinness verwenden den Williamson-Algoritmus,\cite{Wil84} welcher in Linearzeit für einen Graph einen \kf- \bzw \kdd-Homöomorph ausgibt oder feststellt, dass der Graph planar ist.
In der Implementierung wird stattdessen der etwas neuere Planaritätstest von Boyer und Myrvold\cite{BoM04} verwendet, der bereits in \OGDF existiert.
Ergibt der Planaritätstest, dass eine Komponente planar ist, wird sie nicht weiter beachtet.
Enthält sie einen \kf-Minor, kann der Algorithmus stoppen und diesen ausgeben.
Wird ein \kdd-Minor gefunden, wird geprüft, welcher der vier Fälle aus Theorem \ref{eq:Theorem36} zutrifft.
Bei Isomorphie zu $W$ wird die Komponente nicht weiter beachtet.
Ist der \kdd-Minor ein \dd-Separator in der untersuchten Komponente, kann sie in weitere augmentierte Komponenten zerlegt und der Algorithmus rekursiv darauf angewendet werden.
Andernfalls müssen genügend Pfade in der Komponente existieren, sodass der \kdd-Minor auch einen \kf-Minor bildet und der Algorithmus ihn ausgeben und anhalten kann.
Diese Schritte werden solange wiederholt, bis alle augmentierten Komponenten planar, isomorph zu $W$ sind oder ein \kf-Minor gefunden wurde.

\newpage
\begin{minipage}{\linewidth}
\lstinputlisting[language=Python,
                 frame=single,
                 keywordstyle=\color{blue},
                 numbers=left,
                 caption={Algorithmus von Kezdy und McGuinness als Pseudo Code.},
                 captionpos=b]
                {algorithmen/Kezdy_McGuinness.py}
\end{minipage}
